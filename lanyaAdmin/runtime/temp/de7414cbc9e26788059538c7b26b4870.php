<?php /*a:3:{s:60:"/www/wwwroot/yj.shningmi.com/app/wechat/view/keys/index.html";i:1644810384;s:71:"/www/wwwroot/yj.shningmi.com/app/wechat/view/../../admin/view/main.html";i:1644810384;s:67:"/www/wwwroot/yj.shningmi.com/app/wechat/view/keys/index_search.html";i:1644810384;}*/ ?>
<div class="layui-card"><?php if(!(empty($title) || (($title instanceof \think\Collection || $title instanceof \think\Paginator ) && $title->isEmpty()))): ?><div class="layui-card-header notselect"><span class="layui-icon layui-icon-next font-s10 color-desc margin-right-5"></span><?php echo htmlentities((isset($title) && ($title !== '')?$title:''),ENT_QUOTES); ?><div class="pull-right"><!--<?php if(auth("add")): ?>--><button data-open="<?php echo url('add'); ?>" class='layui-btn layui-btn-sm layui-btn-primary'>添加规则</button><!--<?php endif; ?>--><!--<?php if(auth("remove")): ?>--><button data-action='<?php echo url("remove"); ?>' data-rule="id#{key}" data-csrf="<?php echo systoken('remove'); ?>" data-confirm="确定要删除这些规则吗？" class='layui-btn layui-btn-sm layui-btn-primary'>删除规则</button><!--<?php endif; ?>--></div></div><?php endif; ?><div class="layui-card-body"><div class="layui-card-html"><div class="think-box-shadow"><fieldset><legend>条件搜索</legend><form class="layui-form layui-form-pane form-search" action="<?php echo request()->url(); ?>" onsubmit="return false" method="get" autocomplete="off"><div class="layui-form-item layui-inline"><label class="layui-form-label">匹配规则</label><div class="layui-input-inline"><input name="keys" value="<?php echo htmlentities((isset($get['keys']) && ($get['keys'] !== '')?$get['keys']:''),ENT_QUOTES); ?>" placeholder="请输入匹配规则" class="layui-input"></div></div><div class="layui-form-item layui-inline"><label class="layui-form-label">规则类型</label><div class="layui-input-inline"><select class="layui-select" name="type"><option value="">-- 全部 --</option><?php foreach($types as $k => $v): if($k.'' == input('type')): ?><option selected value="<?php echo htmlentities($k,ENT_QUOTES); ?>"><?php echo htmlentities($v,ENT_QUOTES); ?></option><?php else: ?><option value="<?php echo htmlentities($k,ENT_QUOTES); ?>"><?php echo htmlentities($v,ENT_QUOTES); ?></option><?php endif; ?><?php endforeach; ?></select></div></div><div class="layui-form-item layui-inline"><label class="layui-form-label">使用状态</label><div class="layui-input-inline"><select class="layui-select" name="status"><option value="">-- 全部 --</option><?php foreach(['显示已禁止的规则','显示已激活的规则'] as $k=>$v): if(isset($get['status']) and $get['status'] == $k.""): ?><option selected value="<?php echo htmlentities($k,ENT_QUOTES); ?>"><?php echo htmlentities($v,ENT_QUOTES); ?></option><?php else: ?><option value="<?php echo htmlentities($k,ENT_QUOTES); ?>"><?php echo htmlentities($v,ENT_QUOTES); ?></option><?php endif; ?><?php endforeach; ?></select></div></div><div class="layui-form-item layui-inline"><label class="layui-form-label">创建时间</label><div class="layui-input-inline"><input data-date-range name="create_at" value="<?php echo htmlentities((isset($get['create_at']) && ($get['create_at'] !== '')?$get['create_at']:''),ENT_QUOTES); ?>" placeholder="请选择创建时间" class="layui-input"></div></div><div class="layui-form-item layui-inline"><button class="layui-btn layui-btn-primary"><i class="layui-icon">&#xe615;</i> 搜 索</button></div></form><script>window.form.render()</script></fieldset><table class="layui-table margin-top-10" lay-skin="line"><?php if(!(empty($list) || (($list instanceof \think\Collection || $list instanceof \think\Paginator ) && $list->isEmpty()))): ?><thead><tr><th class='list-table-check-td think-checkbox'><label><input data-auto-none data-check-target='.list-check-box' type='checkbox'></label></th><th class='list-table-sort-td'><button type="button" data-reload class="layui-btn layui-btn-xs">刷 新</button></th><th class="text-left nowrap">关键字</th><th class="text-center nowrap">类型</th><th class="text-center nowrap">预览</th><th class="text-left nowrap">添加时间</th><th class="text-left nowrap">状态</th><th></th></tr></thead><?php endif; ?><tbody><?php foreach($list as $key=>$vo): ?><tr><td class='list-table-check-td think-checkbox'><label><input class="list-check-box" value='<?php echo htmlentities($vo['id'],ENT_QUOTES); ?>' type='checkbox'></label></td><td class='list-table-sort-td'><label><input data-action-blur="<?php echo request()->url(); ?>" data-value="id#<?php echo htmlentities($vo['id'],ENT_QUOTES); ?>;action#sort;sort#{value}" data-loading="false" value="<?php echo htmlentities($vo['sort'],ENT_QUOTES); ?>" class="list-sort-input"></label></td><td class="text-left nowrap"><?php if(!(empty($vo['qrc']) || (($vo['qrc'] instanceof \think\Collection || $vo['qrc'] instanceof \think\Paginator ) && $vo['qrc']->isEmpty()))): ?><i class="layui-icon layui-icon-cols font-s12 pointer margin-right-5" data-load="<?php echo htmlentities($vo['qrc'],ENT_QUOTES); ?>" data-time="false" data-tips-text="生成关键字二维码"></i><?php endif; ?><?php echo htmlentities($vo['keys'],ENT_QUOTES); ?></td><td class="text-center nowrap"><?php echo htmlentities($vo['type'],ENT_QUOTES); ?></td><td class="text-center nowrap notselect"><?php if($vo['type'] == '音乐'): ?><a data-phone-view='<?php echo url("@wechat/api.view/music"); ?>?title=<?php echo htmlentities(urlencode($vo['music_title']),ENT_QUOTES); ?>&desc=<?php echo htmlentities(urlencode($vo['music_desc']),ENT_QUOTES); ?>'>预览</i></a><?php elseif(in_array($vo['type'],['文字','转客服'])): ?><a data-phone-view='<?php echo url("@wechat/api.view/text"); ?>?content=<?php echo htmlentities(urlencode($vo['content']),ENT_QUOTES); ?>'>预览</i></a><?php elseif($vo['type'] == '图片'): ?><a data-phone-view='<?php echo url("@wechat/api.view/image"); ?>?content=<?php echo htmlentities(urlencode($vo['image_url']),ENT_QUOTES); ?>'>预览</i></a><?php elseif($vo['type'] == '图文'): ?><a data-phone-view='<?php echo url("@wechat/api.view/news"); ?>?id=<?php echo htmlentities($vo['news_id'],ENT_QUOTES); ?>'>预览</i></a><?php elseif($vo['type'] == '视频'): ?><a data-phone-view='<?php echo url("@wechat/api.view/video"); ?>?title=<?php echo htmlentities(urlencode($vo['video_title']),ENT_QUOTES); ?>&desc=<?php echo htmlentities(urlencode($vo['video_desc']),ENT_QUOTES); ?>&url=<?php echo htmlentities(urlencode($vo['video_url']),ENT_QUOTES); ?>'>预览</i></a><?php elseif($vo['type'] == '语音'): ?><a data-phone-view='<?php echo url("@wechat/api.view/voice"); ?>?content=<?php echo htmlentities(urlencode($vo['voice_url']),ENT_QUOTES); ?>'>预览</i></a><?php else: ?><?php echo htmlentities($vo['content'],ENT_QUOTES); ?><?php endif; ?></td><td class="text-left nowrap"><?php echo htmlentities(format_datetime($vo['create_at']),ENT_QUOTES); ?></td><td class='text-left nowrap'><?php if($vo['status'] == 0): ?><span class="color-red">已禁用</span><?php elseif($vo['status'] == 1): ?><span class="color-green">已激活</span><?php endif; ?></td><td class='text-left nowrap'><!--<?php if(auth("edit")): ?>--><a class="layui-btn layui-btn-sm" data-open='<?php echo url("edit"); ?>?id=<?php echo htmlentities($vo['id'],ENT_QUOTES); ?>'>编 辑</a><!--<?php endif; ?>--><!--<?php if(auth("state") and $vo['status'] == 1): ?>--><a class="layui-btn layui-btn-sm layui-btn-warm" data-action="<?php echo url('state'); ?>" data-value="id#<?php echo htmlentities($vo['id'],ENT_QUOTES); ?>;status#0" data-csrf="<?php echo systoken('state'); ?>">禁 用</a><!--<?php elseif(auth("state") and $vo['status'] == 0): ?>--><a class="layui-btn layui-btn-sm layui-btn-warm" data-action="<?php echo url('state'); ?>" data-value="id#<?php echo htmlentities($vo['id'],ENT_QUOTES); ?>;status#1" data-csrf="<?php echo systoken('state'); ?>">激 活</a><!--<?php endif; ?>--><!--<?php if(auth("remove")): ?>--><a class="layui-btn layui-btn-sm layui-btn-danger" data-confirm="确定要删除该规则吗？" data-action="<?php echo url('remove'); ?>" data-value="id#<?php echo htmlentities($vo['id'],ENT_QUOTES); ?>" data-csrf="<?php echo systoken('remove'); ?>">删 除</a><!--<?php endif; ?>--></td></tr><?php endforeach; ?></tbody></table><?php if(empty($list) || (($list instanceof \think\Collection || $list instanceof \think\Paginator ) && $list->isEmpty())): ?><span class="notdata">没有记录哦</span><?php else: ?><?php echo (isset($pagehtml) && ($pagehtml !== '')?$pagehtml:''); ?><?php endif; ?></div></div></div></div>